<ng-container *ngIf="outputFraction">
  <app-sub-section-title
    class="u-margin-bottom"
    [title]="'WIZARD.OUTPUT-FRACTION.TITLES.OVERVIEW' | translate">
  </app-sub-section-title>
  <div class="m-card--secondary u-margin-bottom"
    *ngFor="let fraction of outputFraction.get('data').controls; let i = index;">
    <div class="l-grid__row l-grid--with-margins">
      <div class="l-grid__col-6-12">
        <app-text-input
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.ELEMENT' | translate"
          [control]="fraction.get('element')"
        ></app-text-input>
      </div>
      <div class="l-grid__col-6-12">
        <app-mass-input
          suffix="kg"
          type="number"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.MASS' | translate"
          [description]="'WIZARD.OUTPUT-FRACTION.DESCRIPTIONS.ON-DRY-WEIGHT-BASIS' | translate"
          [control]="fraction.get('mass')"
          [elements]="outputFraction.get('data').value"
          [labelShare]="'WIZARD.OUTPUT-FRACTION.LABELS.SHARE-OUTPUT-FRACTION' | translate"
        ></app-mass-input>
      </div>
    </div>
    <div class="l-grid__row l-grid--with-margins">
      <div class="l-grid__col-6-12">
        <app-select-input
          class="u-margin-top-x-large"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.CLASSIFICATION' | translate"
          [control]="fraction.get('virginClassification')"
          [options]="codesService.classifications()"
        ></app-select-input>
      </div>
      <div *ngIf="fraction.get('virginClassification').value === classifications.RECYCLING" class="l-grid__col-6-12">
        <app-text-input
          class="u-margin-top-x-large"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.REPLACED-VIRGIN-MATERIAL' | translate"
          [control]="fraction.get('virginReplacedMaterial')"
        ></app-text-input>
      </div>
    </div>
    <div *ngIf="fraction.get('virginClassification').value !== classifications.INTERMEDIATE"
      class="l-grid__row l-grid--with-margins">
      <div class="l-grid__col-6-12">
        <app-text-input
          class="u-margin-top-x-large u-margin-bottom"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.DESTINATION-INDUSTRY' | translate"
          [description]="'WIZARD.OUTPUT-FRACTION.DESCRIPTIONS.OF-ELEMENT' | translate"
          [control]="fraction.get('elementDestinationIndustry')"
        ></app-text-input>
      </div>
      <div class="l-grid__col-6-12">
        <app-select-input
          class="u-margin-top-x-large u-margin-bottom"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.DESTINATION-COMPANY' | translate"
          [control]="fraction.get('elementDestinationCompany')"
          [options]="partners$ | async"
        ></app-select-input>
      </div>
    </div>
    <div *ngIf="fraction.get('virginClassification').value === classifications.INTERMEDIATE"
      class="l-grid__row l-grid--with-margins">
      <div class="l-grid__col-6-12">
        <app-select-input
          class="u-margin-top-x-large u-margin-bottom"
          [label]="'WIZARD.OUTPUT-FRACTION.LABELS.ASSIGNED-STEP' | translate"
          [options]="processSteps$ | async"
          [control]="fraction.get('assignedStep')"
        ></app-select-input>
      </div>
    </div>
    <div class="l-grid__row l-grid--with-margins">
      <button
        *ngIf="!form?.disabled"
        class="u-margin-top-large a-button--link a-button--small"
        (click)="removeElement(fraction, i)"
      >
        {{ 'GENERAL.BUTTONS.DELETE-ELEMENT' | translate }}
      </button>
    </div>
  </div>
  <button *ngIf="!form?.disabled" class="a-button--primary a-button-outline has-icon-after" (click)="addElement()">
    {{ 'WIZARD.OUTPUT-FRACTION.LABELS.ADD-ADDITIONAL-ELEMENT' | translate }} <i class="a-icon a-icon--plus"></i>
  </button>
  <div class="u-margin-top-large">
    <button
      *ngIf="stepId === 0"
      (click)="previousStep()"
      class="a-button--ghost u-margin-right"
    >
      {{ 'WIZARD.BUTTON.BACK-TO-ADDITIVES' | translate }}
    </button>
    <a
      *ngIf="stepId > 0"
      class="a-button--ghost u-margin-right"
      [routerLink]="['../', form.controls[stepId - 1].value.siteRef]"
    >
      {{ 'GENERAL.LABELS.PREVIOUS-STEP' | translate }}
    </a>
    <a
      *ngIf="stepId < (form.controls.length - 1)"
      class="a-button--primary"
      [routerLink]="['../', form.controls[stepId + 1].value.siteRef]"
    >
      {{ 'GENERAL.LABELS.NEXT-STEP' | translate }}
    </a>
    <button
      *ngIf="stepId >= (form.controls.length - 1)"
      (click)="nextStep()"
      class="a-button--primary">
        {{ 'WIZARD.BUTTON.GO-TO-EFFICIENCY' | translate }}
      </button>
  </div>
</ng-container>
